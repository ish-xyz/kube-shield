# Allowed operators: Equal, NotEqual, Regex, GreaterThan, LowerThan
apiVersion: kube-shield.red-labs.co.uk/v1
kind: Policy #or ClusterPolicy
metadata:
  name: some-random-policy
spec:
  applyOn:
    apiVersions:
    - v1
    kinds:
    - Pod
  defaultBehaviour: IfMatchDeny
  policies:
  - name: rule-name
    rules:
    - key: $input.metadata.namespace
      operator: Regex
      value: ^(kube-system|default)$
    # AND
    - key: $input.spec.containers[_].resources.limits.memory
      operator: NotEqual
      value: $input.spec.container[_].resources.requests.memory
  # OR
  - name: second-rule-name
    rules:
    - key: $input.metadata.namespace
      operator: Regex
      value: ^(kube-system|default)$
    # AND
    - key: $input.spec.containers[_].resources.limits.memory
      operator: NotEqual
      value: $input.spec.container[_].resources.requests.memory
