# Allowed operators: Equal, NotEqual, Regex, GreaterThan, LowerThan
apiVersion: kube-shield.red-labs.co.uk/v1
kind: Policy
metadata:
  name: deny-pods-kube-system
spec:
  applyOn:
    - operation: *
      apiVersion: v1
      resource: Pod
  defaultBehaviour: IfMatchDeny
  rules:
  - name: rule-name
    checks:
    - field: $_.input.metadata.namespace
      operator: Equal
      value: kube-system

    # AND
    # - field: $_.input.spec.containers[_].resources.limits.memory
    #   operator: NotEqual
    #   value: $input.spec.container[_].resources.requests.memory
