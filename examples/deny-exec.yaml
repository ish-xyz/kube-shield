apiVersion: kube-shield.red-labs.co.uk/v1
kind: Policy
metadata:
  name: deny-exec
spec:
  applyOn:
  - apiGroup: ""
    resource: "pods/exec"
    verb: "connect"
  rules:
  - name: rule-name
    script: |
      if payload.namespace == "default" and payload.name == "po" then
        return false, "cannot exec into pods in the default namespace"
      else
        return true
      end
